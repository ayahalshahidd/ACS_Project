# Vulnerability Report: Cross-Site Request Forgery (CSRF)

## 1. Executive Summary
**Vulnerability:** Cross-Site Request Forgery (CSRF)
**Severity:** High
**CVSS v3.1 Score:** 8.8 (High)
**Affected Endpoint:** `/api/v1/enrollments` (POST)

The application relies on session cookies for authentication but fails to implement Anti-CSRF protections (such as CSRF tokens or SameSite cookie attributes). This allows an attacker to host a malicious web page that, when visited by an authenticated user, forces the user's browser to send unauthorized requests to the API. Specifically, an attacker can force a user to enroll in or drop courses without their consent.

---

## 2. Technical Details

### Vulnerability Analysis
**Authentication Mechanism:**
The application uses stateful session cookies (`withCredentials: true`). Browsers automatically attach these cookies to any request sent to the domain, regardless of the origin of the request (Cross-Site).

**Missing Defenses:**
1.  **No CSRF Token:** The backend (FastAPI) does not require a unique, unpredictable token in POST/DELETE requests.
2.  **CORS Misconfiguration:** While CORS prevents *reading* the response, it does not stop the request from being *sent* and processed by the server ("Fire and Forget").
3.  **Weak Cookie Attributes:** Cookies lack `SameSite=Strict` or `SameSite=Lax` enforcement in the backend configuration.

### Attack Scenario
1.  The victim logs into the Course Management System.
2.  The attacker creates a malicious site containing a hidden HTML form targeting `/api/v1/enrollments`.
3.  The attacker tricks the victim into visiting this site (e.g., via a phishing link).
4.  JavaScript on the attacker's site automatically submits the form.
5.  The browser sends the POST request including the victim's session cookies.
6.  The backend accepts the valid session and processes the enrollment.
